{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/objectWithoutProperties\";\nimport _toPropertyKey from \"@babel/runtime/helpers/toPropertyKey\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _objectSpread from \"@babel/runtime/helpers/objectSpread2\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport { useState, useEffect, useRef, useCallback } from 'react';\nimport sleep from 'sleep-promise';\nimport useIsMounted from 'react-is-mounted-hook';\nimport { defaultShouldLoadMore } from './defaultShouldLoadMore';\nimport { defaultReduceOptions } from './defaultReduceOptions';\nvar errorText = '[react-select-async-paginate] response of \"loadOptions\" should be an object with \"options\" prop, which contains array of options.';\nexport var validateResponse = function validateResponse(console, response) {\n  if (!response) {\n    console.error(errorText, 'Received:', response);\n    throw new Error(errorText);\n  }\n\n  if (!Array.isArray(response.options)) {\n    console.error(errorText, 'Received:', response);\n    throw new Error(errorText);\n  }\n};\nexport var getInitialOptionsCache = function getInitialOptionsCache(_ref) {\n  var options = _ref.options,\n      defaultOptions = _ref.defaultOptions,\n      additional = _ref.additional,\n      defaultAdditional = _ref.defaultAdditional;\n  var initialOptions = defaultOptions === true ? null : defaultOptions instanceof Array ? defaultOptions : options;\n\n  if (initialOptions) {\n    return {\n      '': {\n        isFirstLoad: false,\n        isLoading: false,\n        options: initialOptions,\n        hasMore: true,\n        additional: defaultAdditional || additional\n      }\n    };\n  }\n\n  return {};\n};\nexport var getInitialCache = function getInitialCache(params) {\n  return {\n    isFirstLoad: true,\n    options: [],\n    hasMore: true,\n    isLoading: false,\n    additional: params.additional\n  };\n};\nexport var requestOptions = /*#__PURE__*/function () {\n  var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(paramsRef, optionsCacheRef, debounceTimeout, sleepParam, setOptionsCache, validateResponseParam, reduceOptions) {\n    var currentInputValue, isCacheEmpty, currentOptions, newInputValue, response, hasError, loadOptions, _response, options, hasMore, newAdditional;\n\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            currentInputValue = paramsRef.current.inputValue;\n            isCacheEmpty = !optionsCacheRef.current[currentInputValue];\n            currentOptions = isCacheEmpty ? getInitialCache(paramsRef.current) : optionsCacheRef.current[currentInputValue];\n\n            if (!(currentOptions.isLoading || !currentOptions.hasMore)) {\n              _context.next = 5;\n              break;\n            }\n\n            return _context.abrupt(\"return\");\n\n          case 5:\n            setOptionsCache(function (prevOptionsCache) {\n              return _objectSpread(_objectSpread({}, prevOptionsCache), {}, _defineProperty({}, currentInputValue, _objectSpread(_objectSpread({}, currentOptions), {}, {\n                isLoading: true\n              })));\n            });\n\n            if (!(debounceTimeout > 0)) {\n              _context.next = 13;\n              break;\n            }\n\n            _context.next = 9;\n            return sleepParam(debounceTimeout);\n\n          case 9:\n            newInputValue = paramsRef.current.inputValue;\n\n            if (!(currentInputValue !== newInputValue)) {\n              _context.next = 13;\n              break;\n            }\n\n            setOptionsCache(function (prevOptionsCache) {\n              if (isCacheEmpty) {\n                var itemForDelete = prevOptionsCache[currentInputValue],\n                    restCache = _objectWithoutProperties(prevOptionsCache, [currentInputValue].map(_toPropertyKey));\n\n                return restCache;\n              }\n\n              return _objectSpread(_objectSpread({}, prevOptionsCache), {}, _defineProperty({}, currentInputValue, _objectSpread(_objectSpread({}, currentOptions), {}, {\n                isLoading: false\n              })));\n            });\n            return _context.abrupt(\"return\");\n\n          case 13:\n            _context.prev = 13;\n            loadOptions = paramsRef.current.loadOptions;\n            _context.next = 17;\n            return loadOptions(currentInputValue, currentOptions.options, currentOptions.additional);\n\n          case 17:\n            response = _context.sent;\n            hasError = false;\n            _context.next = 24;\n            break;\n\n          case 21:\n            _context.prev = 21;\n            _context.t0 = _context[\"catch\"](13);\n            hasError = true;\n\n          case 24:\n            if (!hasError) {\n              _context.next = 27;\n              break;\n            }\n\n            setOptionsCache(function (prevOptionsCache) {\n              return _objectSpread(_objectSpread({}, prevOptionsCache), {}, _defineProperty({}, currentInputValue, _objectSpread(_objectSpread({}, currentOptions), {}, {\n                isLoading: false\n              })));\n            });\n            return _context.abrupt(\"return\");\n\n          case 27:\n            validateResponseParam(console, response);\n            _response = response, options = _response.options, hasMore = _response.hasMore; // eslint-disable-next-line no-prototype-builtins\n\n            newAdditional = response.hasOwnProperty('additional') ? response.additional : currentOptions.additional;\n            setOptionsCache(function (prevOptionsCache) {\n              return _objectSpread(_objectSpread({}, prevOptionsCache), {}, _defineProperty({}, currentInputValue, _objectSpread(_objectSpread({}, currentOptions), {}, {\n                options: reduceOptions(currentOptions.options, options, newAdditional),\n                hasMore: !!hasMore,\n                isLoading: false,\n                isFirstLoad: false,\n                additional: newAdditional\n              })));\n            });\n\n          case 31:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee, null, [[13, 21]]);\n  }));\n\n  return function requestOptions(_x, _x2, _x3, _x4, _x5, _x6, _x7) {\n    return _ref2.apply(this, arguments);\n  };\n}();\nexport var increaseStateId = function increaseStateId(prevStateId) {\n  return prevStateId + 1;\n};\nexport var useAsyncPaginateBasePure = function useAsyncPaginateBasePure(useRefParam, useStateParam, useEffectParam, useCallbackParam, useIsMountedParam, validateResponseParam, getInitialOptionsCacheParam, requestOptionsParam, params) {\n  var deps = arguments.length > 9 && arguments[9] !== undefined ? arguments[9] : [];\n  var defaultOptions = params.defaultOptions,\n      _params$loadOptionsOn = params.loadOptionsOnMenuOpen,\n      loadOptionsOnMenuOpen = _params$loadOptionsOn === void 0 ? true : _params$loadOptionsOn,\n      _params$debounceTimeo = params.debounceTimeout,\n      debounceTimeout = _params$debounceTimeo === void 0 ? 0 : _params$debounceTimeo,\n      inputValue = params.inputValue,\n      menuIsOpen = params.menuIsOpen,\n      _params$filterOption = params.filterOption,\n      filterOption = _params$filterOption === void 0 ? null : _params$filterOption,\n      _params$reduceOptions = params.reduceOptions,\n      reduceOptions = _params$reduceOptions === void 0 ? defaultReduceOptions : _params$reduceOptions,\n      _params$shouldLoadMor = params.shouldLoadMore,\n      shouldLoadMore = _params$shouldLoadMor === void 0 ? defaultShouldLoadMore : _params$shouldLoadMor;\n  var isMounted = useIsMountedParam();\n  var isInitRef = useRefParam(true);\n  var paramsRef = useRefParam(params);\n  paramsRef.current = params;\n  var setStateId = useStateParam(0)[1];\n  var optionsCacheRef = useRefParam(null);\n\n  if (optionsCacheRef.current === null) {\n    optionsCacheRef.current = getInitialOptionsCacheParam(params);\n  }\n\n  var callRequestOptions = useCallbackParam(function () {\n    requestOptionsParam(paramsRef, optionsCacheRef, debounceTimeout, sleep, function (reduceState) {\n      optionsCacheRef.current = reduceState(optionsCacheRef.current);\n\n      if (isMounted()) {\n        setStateId(increaseStateId);\n      }\n    }, validateResponseParam, reduceOptions);\n  }, []);\n  var handleScrolledToBottom = useCallbackParam(function () {\n    var currentInputValue = paramsRef.current.inputValue;\n    var currentOptions = optionsCacheRef.current[currentInputValue];\n\n    if (currentOptions) {\n      callRequestOptions();\n    }\n  }, []);\n  useEffectParam(function () {\n    if (isInitRef.current) {\n      isInitRef.current = false;\n    } else {\n      optionsCacheRef.current = {};\n      setStateId(increaseStateId);\n    }\n\n    if (defaultOptions === true) {\n      callRequestOptions();\n    }\n  }, deps);\n  useEffectParam(function () {\n    if (menuIsOpen && !optionsCacheRef.current[inputValue]) {\n      callRequestOptions();\n    }\n  }, [inputValue]);\n  useEffectParam(function () {\n    if (menuIsOpen && !optionsCacheRef.current[''] && loadOptionsOnMenuOpen) {\n      callRequestOptions();\n    }\n  }, [menuIsOpen]);\n  var currentOptions = optionsCacheRef.current[inputValue] || getInitialCache(params);\n  return {\n    handleScrolledToBottom: handleScrolledToBottom,\n    shouldLoadMore: shouldLoadMore,\n    filterOption: filterOption,\n    isLoading: currentOptions.isLoading,\n    isFirstLoad: currentOptions.isFirstLoad,\n    options: currentOptions.options\n  };\n};\nexport var useAsyncPaginateBase = function useAsyncPaginateBase(params) {\n  var deps = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n  return useAsyncPaginateBasePure(useRef, useState, useEffect, useCallback, useIsMounted, validateResponse, getInitialOptionsCache, requestOptions, params, deps);\n};","map":{"version":3,"sources":["D:/PhladRian/frontend/node_modules/react-select-async-paginate/es/useAsyncPaginateBase.js"],"names":["_regeneratorRuntime","_objectWithoutProperties","_toPropertyKey","_defineProperty","_objectSpread","_asyncToGenerator","useState","useEffect","useRef","useCallback","sleep","useIsMounted","defaultShouldLoadMore","defaultReduceOptions","errorText","validateResponse","console","response","error","Error","Array","isArray","options","getInitialOptionsCache","_ref","defaultOptions","additional","defaultAdditional","initialOptions","isFirstLoad","isLoading","hasMore","getInitialCache","params","requestOptions","_ref2","mark","_callee","paramsRef","optionsCacheRef","debounceTimeout","sleepParam","setOptionsCache","validateResponseParam","reduceOptions","currentInputValue","isCacheEmpty","currentOptions","newInputValue","hasError","loadOptions","_response","newAdditional","wrap","_callee$","_context","prev","next","current","inputValue","abrupt","prevOptionsCache","itemForDelete","restCache","map","sent","t0","hasOwnProperty","stop","_x","_x2","_x3","_x4","_x5","_x6","_x7","apply","arguments","increaseStateId","prevStateId","useAsyncPaginateBasePure","useRefParam","useStateParam","useEffectParam","useCallbackParam","useIsMountedParam","getInitialOptionsCacheParam","requestOptionsParam","deps","length","undefined","_params$loadOptionsOn","loadOptionsOnMenuOpen","_params$debounceTimeo","menuIsOpen","_params$filterOption","filterOption","_params$reduceOptions","_params$shouldLoadMor","shouldLoadMore","isMounted","isInitRef","setStateId","callRequestOptions","reduceState","handleScrolledToBottom","useAsyncPaginateBase"],"mappings":"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","sourcesContent":["import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/objectWithoutProperties\";\nimport _toPropertyKey from \"@babel/runtime/helpers/toPropertyKey\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _objectSpread from \"@babel/runtime/helpers/objectSpread2\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport { useState, useEffect, useRef, useCallback } from 'react';\nimport sleep from 'sleep-promise';\nimport useIsMounted from 'react-is-mounted-hook';\nimport { defaultShouldLoadMore } from './defaultShouldLoadMore';\nimport { defaultReduceOptions } from './defaultReduceOptions';\nvar errorText = '[react-select-async-paginate] response of \"loadOptions\" should be an object with \"options\" prop, which contains array of options.';\nexport var validateResponse = function validateResponse(console, response) {\n  if (!response) {\n    console.error(errorText, 'Received:', response);\n    throw new Error(errorText);\n  }\n\n  if (!Array.isArray(response.options)) {\n    console.error(errorText, 'Received:', response);\n    throw new Error(errorText);\n  }\n};\nexport var getInitialOptionsCache = function getInitialOptionsCache(_ref) {\n  var options = _ref.options,\n      defaultOptions = _ref.defaultOptions,\n      additional = _ref.additional,\n      defaultAdditional = _ref.defaultAdditional;\n  var initialOptions = defaultOptions === true ? null : defaultOptions instanceof Array ? defaultOptions : options;\n\n  if (initialOptions) {\n    return {\n      '': {\n        isFirstLoad: false,\n        isLoading: false,\n        options: initialOptions,\n        hasMore: true,\n        additional: defaultAdditional || additional\n      }\n    };\n  }\n\n  return {};\n};\nexport var getInitialCache = function getInitialCache(params) {\n  return {\n    isFirstLoad: true,\n    options: [],\n    hasMore: true,\n    isLoading: false,\n    additional: params.additional\n  };\n};\nexport var requestOptions = /*#__PURE__*/function () {\n  var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(paramsRef, optionsCacheRef, debounceTimeout, sleepParam, setOptionsCache, validateResponseParam, reduceOptions) {\n    var currentInputValue, isCacheEmpty, currentOptions, newInputValue, response, hasError, loadOptions, _response, options, hasMore, newAdditional;\n\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            currentInputValue = paramsRef.current.inputValue;\n            isCacheEmpty = !optionsCacheRef.current[currentInputValue];\n            currentOptions = isCacheEmpty ? getInitialCache(paramsRef.current) : optionsCacheRef.current[currentInputValue];\n\n            if (!(currentOptions.isLoading || !currentOptions.hasMore)) {\n              _context.next = 5;\n              break;\n            }\n\n            return _context.abrupt(\"return\");\n\n          case 5:\n            setOptionsCache(function (prevOptionsCache) {\n              return _objectSpread(_objectSpread({}, prevOptionsCache), {}, _defineProperty({}, currentInputValue, _objectSpread(_objectSpread({}, currentOptions), {}, {\n                isLoading: true\n              })));\n            });\n\n            if (!(debounceTimeout > 0)) {\n              _context.next = 13;\n              break;\n            }\n\n            _context.next = 9;\n            return sleepParam(debounceTimeout);\n\n          case 9:\n            newInputValue = paramsRef.current.inputValue;\n\n            if (!(currentInputValue !== newInputValue)) {\n              _context.next = 13;\n              break;\n            }\n\n            setOptionsCache(function (prevOptionsCache) {\n              if (isCacheEmpty) {\n                var itemForDelete = prevOptionsCache[currentInputValue],\n                    restCache = _objectWithoutProperties(prevOptionsCache, [currentInputValue].map(_toPropertyKey));\n\n                return restCache;\n              }\n\n              return _objectSpread(_objectSpread({}, prevOptionsCache), {}, _defineProperty({}, currentInputValue, _objectSpread(_objectSpread({}, currentOptions), {}, {\n                isLoading: false\n              })));\n            });\n            return _context.abrupt(\"return\");\n\n          case 13:\n            _context.prev = 13;\n            loadOptions = paramsRef.current.loadOptions;\n            _context.next = 17;\n            return loadOptions(currentInputValue, currentOptions.options, currentOptions.additional);\n\n          case 17:\n            response = _context.sent;\n            hasError = false;\n            _context.next = 24;\n            break;\n\n          case 21:\n            _context.prev = 21;\n            _context.t0 = _context[\"catch\"](13);\n            hasError = true;\n\n          case 24:\n            if (!hasError) {\n              _context.next = 27;\n              break;\n            }\n\n            setOptionsCache(function (prevOptionsCache) {\n              return _objectSpread(_objectSpread({}, prevOptionsCache), {}, _defineProperty({}, currentInputValue, _objectSpread(_objectSpread({}, currentOptions), {}, {\n                isLoading: false\n              })));\n            });\n            return _context.abrupt(\"return\");\n\n          case 27:\n            validateResponseParam(console, response);\n            _response = response, options = _response.options, hasMore = _response.hasMore; // eslint-disable-next-line no-prototype-builtins\n\n            newAdditional = response.hasOwnProperty('additional') ? response.additional : currentOptions.additional;\n            setOptionsCache(function (prevOptionsCache) {\n              return _objectSpread(_objectSpread({}, prevOptionsCache), {}, _defineProperty({}, currentInputValue, _objectSpread(_objectSpread({}, currentOptions), {}, {\n                options: reduceOptions(currentOptions.options, options, newAdditional),\n                hasMore: !!hasMore,\n                isLoading: false,\n                isFirstLoad: false,\n                additional: newAdditional\n              })));\n            });\n\n          case 31:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee, null, [[13, 21]]);\n  }));\n\n  return function requestOptions(_x, _x2, _x3, _x4, _x5, _x6, _x7) {\n    return _ref2.apply(this, arguments);\n  };\n}();\nexport var increaseStateId = function increaseStateId(prevStateId) {\n  return prevStateId + 1;\n};\nexport var useAsyncPaginateBasePure = function useAsyncPaginateBasePure(useRefParam, useStateParam, useEffectParam, useCallbackParam, useIsMountedParam, validateResponseParam, getInitialOptionsCacheParam, requestOptionsParam, params) {\n  var deps = arguments.length > 9 && arguments[9] !== undefined ? arguments[9] : [];\n  var defaultOptions = params.defaultOptions,\n      _params$loadOptionsOn = params.loadOptionsOnMenuOpen,\n      loadOptionsOnMenuOpen = _params$loadOptionsOn === void 0 ? true : _params$loadOptionsOn,\n      _params$debounceTimeo = params.debounceTimeout,\n      debounceTimeout = _params$debounceTimeo === void 0 ? 0 : _params$debounceTimeo,\n      inputValue = params.inputValue,\n      menuIsOpen = params.menuIsOpen,\n      _params$filterOption = params.filterOption,\n      filterOption = _params$filterOption === void 0 ? null : _params$filterOption,\n      _params$reduceOptions = params.reduceOptions,\n      reduceOptions = _params$reduceOptions === void 0 ? defaultReduceOptions : _params$reduceOptions,\n      _params$shouldLoadMor = params.shouldLoadMore,\n      shouldLoadMore = _params$shouldLoadMor === void 0 ? defaultShouldLoadMore : _params$shouldLoadMor;\n  var isMounted = useIsMountedParam();\n  var isInitRef = useRefParam(true);\n  var paramsRef = useRefParam(params);\n  paramsRef.current = params;\n  var setStateId = useStateParam(0)[1];\n  var optionsCacheRef = useRefParam(null);\n\n  if (optionsCacheRef.current === null) {\n    optionsCacheRef.current = getInitialOptionsCacheParam(params);\n  }\n\n  var callRequestOptions = useCallbackParam(function () {\n    requestOptionsParam(paramsRef, optionsCacheRef, debounceTimeout, sleep, function (reduceState) {\n      optionsCacheRef.current = reduceState(optionsCacheRef.current);\n\n      if (isMounted()) {\n        setStateId(increaseStateId);\n      }\n    }, validateResponseParam, reduceOptions);\n  }, []);\n  var handleScrolledToBottom = useCallbackParam(function () {\n    var currentInputValue = paramsRef.current.inputValue;\n    var currentOptions = optionsCacheRef.current[currentInputValue];\n\n    if (currentOptions) {\n      callRequestOptions();\n    }\n  }, []);\n  useEffectParam(function () {\n    if (isInitRef.current) {\n      isInitRef.current = false;\n    } else {\n      optionsCacheRef.current = {};\n      setStateId(increaseStateId);\n    }\n\n    if (defaultOptions === true) {\n      callRequestOptions();\n    }\n  }, deps);\n  useEffectParam(function () {\n    if (menuIsOpen && !optionsCacheRef.current[inputValue]) {\n      callRequestOptions();\n    }\n  }, [inputValue]);\n  useEffectParam(function () {\n    if (menuIsOpen && !optionsCacheRef.current[''] && loadOptionsOnMenuOpen) {\n      callRequestOptions();\n    }\n  }, [menuIsOpen]);\n  var currentOptions = optionsCacheRef.current[inputValue] || getInitialCache(params);\n  return {\n    handleScrolledToBottom: handleScrolledToBottom,\n    shouldLoadMore: shouldLoadMore,\n    filterOption: filterOption,\n    isLoading: currentOptions.isLoading,\n    isFirstLoad: currentOptions.isFirstLoad,\n    options: currentOptions.options\n  };\n};\nexport var useAsyncPaginateBase = function useAsyncPaginateBase(params) {\n  var deps = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n  return useAsyncPaginateBasePure(useRef, useState, useEffect, useCallback, useIsMounted, validateResponse, getInitialOptionsCache, requestOptions, params, deps);\n};"]},"metadata":{},"sourceType":"module"}